{
  "openapi": "3.0.3",
  "info": {
    "title": "App Directory API",
    "description": "AI-First Application Directory \u2014 agents discover, submit, and rate AI-native services and tools",
    "version": "0.10.0",
    "x-event-types": {
      "description": "SSE event types emitted on /events/stream",
      "types": [
        "app.submitted",
        "app.approved",
        "app.rejected",
        "app.deprecated",
        "app.undeprecated",
        "app.updated",
        "app.deleted",
        "review.submitted",
        "health.checked",
        "warning"
      ]
    }
  },
  "servers": [
    {
      "url": "http://localhost:8002/api/v1"
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "summary": "Health check",
        "operationId": "health",
        "responses": {
          "200": {
            "description": "Service is healthy"
          }
        }
      }
    },
    "/apps": {
      "get": {
        "summary": "List apps",
        "operationId": "listApps",
        "parameters": [
          {
            "name": "category",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "protocol",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "default": "approved"
            }
          },
          {
            "name": "featured",
            "in": "query",
            "schema": {
              "type": "boolean"
            },
            "description": "Filter to featured apps only"
          },
          {
            "name": "verified",
            "in": "query",
            "schema": {
              "type": "boolean"
            },
            "description": "Filter to verified apps only"
          },
          {
            "name": "health",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "healthy",
                "unhealthy",
                "unreachable",
                "unknown"
              ]
            },
            "description": "Filter by health check status"
          },
          {
            "name": "sort",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "newest",
                "rating",
                "name",
                "oldest"
              ]
            }
          },
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 20,
              "maximum": 100
            }
          }
        ],
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of apps"
          }
        }
      },
      "post": {
        "summary": "Submit a new app",
        "operationId": "submitApp",
        "security": [
          {
            "apiKey": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubmitAppRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "App submitted"
          },
          "400": {
            "description": "Validation error"
          }
        }
      }
    },
    "/apps/search": {
      "get": {
        "summary": "Search apps by keyword",
        "operationId": "searchApps",
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "category",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "protocol",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Search results"
          }
        }
      }
    },
    "/apps/{id}": {
      "get": {
        "summary": "Get app by ID or slug",
        "operationId": "getApp",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "App details"
          },
          "404": {
            "description": "Not found"
          }
        }
      },
      "patch": {
        "summary": "Update app",
        "description": "Update app details. Auth via edit token (?token= query param or X-Edit-Token header), API key (owner), or admin key. Edit tokens cannot change status, featured, or verified badges.",
        "operationId": "updateApp",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "token",
            "in": "query",
            "required": false,
            "description": "Edit token returned on app creation",
            "schema": {
              "type": "string"
            }
          }
        ],
        "security": [
          {},
          {
            "apiKey": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAppRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "App updated"
          }
        }
      },
      "delete": {
        "summary": "Delete app",
        "operationId": "deleteApp",
        "description": "Delete app and all associated data. Auth via edit token (?token= query param or X-Edit-Token header), API key (owner), or admin key.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "token",
            "in": "query",
            "required": false,
            "description": "Edit token returned on app creation",
            "schema": {
              "type": "string"
            }
          }
        ],
        "security": [
          {},
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "App deleted"
          }
        }
      }
    },
    "/apps/{id}/reviews": {
      "get": {
        "summary": "Get reviews for an app",
        "operationId": "getReviews",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated reviews"
          }
        }
      },
      "post": {
        "summary": "Submit or update a review",
        "operationId": "submitReview",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "security": [
          {
            "apiKey": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubmitReviewRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Review submitted"
          }
        }
      }
    },
    "/categories": {
      "get": {
        "summary": "List categories with app counts",
        "operationId": "listCategories",
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Categories and valid enums"
          }
        }
      }
    },
    "/keys": {
      "get": {
        "summary": "List API keys (admin)",
        "operationId": "listKeys",
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "API keys"
          }
        }
      },
      "post": {
        "summary": "Create API key (admin)",
        "operationId": "createKey",
        "security": [
          {
            "apiKey": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateKeyRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Key created"
          }
        }
      }
    },
    "/keys/{id}": {
      "delete": {
        "summary": "Revoke API key (admin)",
        "operationId": "deleteKey",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Key revoked"
          }
        }
      }
    },
    "/apps/{id}/health-check": {
      "post": {
        "summary": "Trigger health check for an app (admin only)",
        "description": "Performs an HTTP GET to the app's api_url (or homepage_url) and records the result. Updates the app's cached health status and uptime percentage.",
        "operationId": "checkAppHealth",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "App ID or slug"
          }
        ],
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Health check completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthCheckResult"
                }
              }
            }
          },
          "403": {
            "description": "Admin only"
          },
          "404": {
            "description": "App not found"
          },
          "422": {
            "description": "App has no URL to check"
          }
        }
      }
    },
    "/apps/health-check/batch": {
      "post": {
        "summary": "Batch health check all approved apps (admin only)",
        "description": "Checks all approved apps that have an api_url or homepage_url. Returns a summary with per-app results.",
        "operationId": "batchHealthCheck",
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Batch results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchHealthCheckResult"
                }
              }
            }
          },
          "403": {
            "description": "Admin only"
          }
        }
      }
    },
    "/apps/{id}/health": {
      "get": {
        "summary": "Get health check history for an app",
        "operationId": "getHealthHistory",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "App ID or slug"
          },
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated health check history with uptime percentage"
          },
          "404": {
            "description": "App not found"
          }
        }
      }
    },
    "/apps/health/summary": {
      "get": {
        "summary": "Health status overview of all apps",
        "description": "Returns counts of healthy, unhealthy, and unreachable apps, plus a list of apps with issues.",
        "operationId": "healthSummary",
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Health summary"
          }
        }
      }
    },
    "/health-check/schedule": {
      "get": {
        "summary": "View scheduled health check configuration",
        "description": "Returns the current scheduler configuration including interval, enabled status, and the environment variable to configure it. Set HEALTH_CHECK_INTERVAL_SECS=0 to disable.",
        "operationId": "getHealthCheckSchedule",
        "security": [
          {
            "apiKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Scheduler configuration",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "enabled": {
                      "type": "boolean",
                      "description": "Whether scheduled health checks are active"
                    },
                    "interval_seconds": {
                      "type": "integer",
                      "description": "Seconds between health check runs"
                    },
                    "description": {
                      "type": "string"
                    },
                    "config_var": {
                      "type": "string",
                      "description": "Environment variable to configure the interval"
                    },
                    "default_interval": {
                      "type": "integer",
                      "description": "Default interval in seconds (300 = 5 minutes)"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Admin required"
          }
        }
      }
    },
    "/webhooks": {
      "post": {
        "summary": "Register a webhook",
        "description": "Register a new webhook to receive event notifications. Admin only. The secret is shown only once in the response.",
        "operationId": "createWebhook",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "url"
                ],
                "properties": {
                  "url": {
                    "type": "string",
                    "description": "HTTPS URL to deliver events to"
                  },
                  "events": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Event types to subscribe to. Empty = all events. Valid: app.submitted, app.approved, app.updated, app.deleted, review.submitted, health.checked"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Webhook created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookWithSecret"
                }
              }
            }
          },
          "400": {
            "description": "Invalid URL or event type"
          },
          "403": {
            "description": "Admin required"
          }
        }
      },
      "get": {
        "summary": "List webhooks",
        "description": "List all registered webhooks. Admin only. Secrets are not included.",
        "operationId": "listWebhooks",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Webhook list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "webhooks": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Webhook"
                      }
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Admin required"
          }
        }
      }
    },
    "/webhooks/{webhookId}": {
      "patch": {
        "summary": "Update a webhook",
        "description": "Update webhook URL, events filter, or active status. Re-activating resets failure count. Admin only.",
        "operationId": "updateWebhook",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "parameters": [
          {
            "name": "webhookId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "url": {
                    "type": "string"
                  },
                  "events": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "active": {
                    "type": "boolean"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated webhook",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Webhook"
                }
              }
            }
          },
          "400": {
            "description": "Invalid URL or event type"
          },
          "403": {
            "description": "Admin required"
          },
          "404": {
            "description": "Webhook not found"
          }
        }
      },
      "delete": {
        "summary": "Delete a webhook",
        "description": "Permanently delete a webhook registration. Admin only.",
        "operationId": "deleteWebhook",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "parameters": [
          {
            "name": "webhookId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Webhook deleted"
          },
          "403": {
            "description": "Admin required"
          },
          "404": {
            "description": "Webhook not found"
          }
        }
      }
    },
    "/events/stream": {
      "get": {
        "summary": "Real-time event stream (SSE)",
        "description": "Server-Sent Events stream for real-time directory events. No auth required. Emits events for app submissions, approvals, updates, deletions, reviews, and health checks. Sends a heartbeat every 15 seconds to keep connections alive.",
        "operationId": "eventStream",
        "tags": [
          "events"
        ],
        "security": [],
        "responses": {
          "200": {
            "description": "SSE event stream",
            "content": {
              "text/event-stream": {
                "schema": {
                  "type": "string",
                  "description": "Server-Sent Events stream. Each event has a `event` field (type) and `data` field (JSON payload)."
                },
                "example": "event: app.submitted\ndata: {\"app_id\":\"abc-123\",\"name\":\"My App\",\"slug\":\"my-app\",\"status\":\"pending\"}\n\n"
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/apps/pending": {
      "get": {
        "summary": "List pending apps",
        "description": "Returns all apps awaiting admin review. Admin only.",
        "operationId": "listPendingApps",
        "tags": [
          "Approval Workflow"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 20,
              "maximum": 100
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of pending apps",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "items": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/PendingApp"
                      }
                    },
                    "total": {
                      "type": "integer"
                    },
                    "page": {
                      "type": "integer"
                    },
                    "per_page": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Admin required"
          }
        }
      }
    },
    "/apps/{id}/approve": {
      "post": {
        "summary": "Approve an app",
        "description": "Transitions a pending or rejected app to approved status. Admin only. Emits app.approved event.",
        "operationId": "approveApp",
        "tags": [
          "Approval Workflow"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "note": {
                    "type": "string",
                    "nullable": true,
                    "description": "Optional note about the approval decision"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "App approved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "app_id": {
                      "type": "string"
                    },
                    "previous_status": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Admin required"
          },
          "404": {
            "description": "App not found"
          },
          "409": {
            "description": "Already approved or invalid transition"
          }
        }
      }
    },
    "/apps/{id}/reject": {
      "post": {
        "summary": "Reject an app",
        "description": "Transitions a pending or approved app to rejected status. Admin only. Requires a reason. Emits app.rejected event.",
        "operationId": "rejectApp",
        "tags": [
          "Approval Workflow"
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "reason"
                ],
                "properties": {
                  "reason": {
                    "type": "string",
                    "description": "Required reason for rejection"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "App rejected",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "app_id": {
                      "type": "string"
                    },
                    "previous_status": {
                      "type": "string"
                    },
                    "reason": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Reason required"
          },
          "403": {
            "description": "Admin required"
          },
          "404": {
            "description": "App not found"
          },
          "409": {
            "description": "Already rejected or invalid transition"
          }
        }
      }
    },
    "/apps/{id}/deprecate": {
      "post": {
        "summary": "Deprecate an app (admin only)",
        "description": "Marks an app as deprecated with a required reason. Optionally specify a replacement app and/or sunset date. Emits app.deprecated event.",
        "operationId": "deprecateApp",
        "tags": [
          "Deprecation"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "App ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "reason"
                ],
                "properties": {
                  "reason": {
                    "type": "string",
                    "description": "Required reason for deprecation"
                  },
                  "replacement_app_id": {
                    "type": "string",
                    "description": "Optional ID of the replacement/successor app"
                  },
                  "sunset_at": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Optional date when the app will stop working (ISO-8601)"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "App deprecated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "app_id": {
                      "type": "string"
                    },
                    "previous_status": {
                      "type": "string"
                    },
                    "reason": {
                      "type": "string"
                    },
                    "replacement_app_id": {
                      "type": "string",
                      "nullable": true
                    },
                    "sunset_at": {
                      "type": "string",
                      "nullable": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Reason required or invalid replacement"
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "App not found"
          },
          "409": {
            "description": "Already deprecated"
          }
        }
      }
    },
    "/apps/{id}/undeprecate": {
      "post": {
        "summary": "Undeprecate an app (admin only)",
        "description": "Restores a deprecated app to approved status and clears deprecation metadata. Emits app.undeprecated event.",
        "operationId": "undeprecateApp",
        "tags": [
          "Deprecation"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "App ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "App undeprecated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "app_id": {
                      "type": "string"
                    },
                    "restored_to": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "App not found"
          },
          "409": {
            "description": "App is not deprecated"
          }
        }
      }
    },
    "/apps/{id}/stats": {
      "get": {
        "summary": "Get app statistics",
        "description": "Returns view counts (total, 24h, 7d, 30d), unique viewers for an app. Accepts app ID or slug.",
        "operationId": "getAppStats",
        "tags": [
          "Statistics"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "App ID or slug",
            "schema": {
              "type": "string"
            }
          }
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "App statistics",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "app_id": {
                      "type": "string"
                    },
                    "total_views": {
                      "type": "integer"
                    },
                    "views_24h": {
                      "type": "integer"
                    },
                    "views_7d": {
                      "type": "integer"
                    },
                    "views_30d": {
                      "type": "integer"
                    },
                    "unique_viewers": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "App not found"
          }
        }
      }
    },
    "/apps/trending": {
      "get": {
        "summary": "Trending apps",
        "description": "Returns apps ranked by views in a given period. Shows view count, unique viewers, and views per day.",
        "operationId": "getTrendingApps",
        "tags": [
          "Statistics"
        ],
        "parameters": [
          {
            "name": "days",
            "in": "query",
            "required": false,
            "description": "Lookback period in days (1-90, default 7)",
            "schema": {
              "type": "integer",
              "default": 7,
              "minimum": 1,
              "maximum": 90
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "description": "Max results (1-50, default 10)",
            "schema": {
              "type": "integer",
              "default": 10,
              "minimum": 1,
              "maximum": 50
            }
          }
        ],
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Trending apps list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "trending": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "slug": {
                            "type": "string"
                          },
                          "short_description": {
                            "type": "string"
                          },
                          "protocol": {
                            "type": "string"
                          },
                          "category": {
                            "type": "string"
                          },
                          "tags": {
                            "type": "array",
                            "items": {
                              "type": "string"
                            }
                          },
                          "is_featured": {
                            "type": "boolean"
                          },
                          "is_verified": {
                            "type": "boolean"
                          },
                          "avg_rating": {
                            "type": "number"
                          },
                          "review_count": {
                            "type": "integer"
                          },
                          "view_count": {
                            "type": "integer"
                          },
                          "unique_viewers": {
                            "type": "integer"
                          },
                          "views_per_day": {
                            "type": "number"
                          }
                        }
                      }
                    },
                    "period_days": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "apiKey": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key"
      }
    },
    "schemas": {
      "SubmitAppRequest": {
        "type": "object",
        "required": [
          "name",
          "short_description",
          "description",
          "author_name"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "short_description": {
            "type": "string",
            "maxLength": 200
          },
          "description": {
            "type": "string"
          },
          "homepage_url": {
            "type": "string",
            "format": "uri"
          },
          "api_url": {
            "type": "string",
            "format": "uri"
          },
          "api_spec_url": {
            "type": "string",
            "format": "uri",
            "description": "URL to OpenAPI/GraphQL/gRPC spec"
          },
          "protocol": {
            "type": "string",
            "enum": [
              "rest",
              "graphql",
              "grpc",
              "mcp",
              "a2a",
              "websocket",
              "other"
            ],
            "default": "rest"
          },
          "category": {
            "type": "string",
            "enum": [
              "communication",
              "data",
              "developer-tools",
              "finance",
              "media",
              "productivity",
              "search",
              "security",
              "social",
              "ai-ml",
              "infrastructure",
              "other"
            ],
            "default": "other"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "logo_url": {
            "type": "string",
            "format": "uri"
          },
          "author_name": {
            "type": "string"
          },
          "author_url": {
            "type": "string",
            "format": "uri"
          }
        }
      },
      "UpdateAppRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "short_description": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "homepage_url": {
            "type": "string"
          },
          "api_url": {
            "type": "string"
          },
          "api_spec_url": {
            "type": "string"
          },
          "protocol": {
            "type": "string"
          },
          "category": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "logo_url": {
            "type": "string"
          },
          "author_name": {
            "type": "string"
          },
          "author_url": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "approved",
              "rejected",
              "deprecated"
            ],
            "description": "Admin only"
          },
          "is_featured": {
            "type": "boolean",
            "description": "Admin only \u2014 highlight app as featured"
          },
          "is_verified": {
            "type": "boolean",
            "description": "Admin only \u2014 mark app as verified/trusted"
          }
        }
      },
      "SubmitReviewRequest": {
        "type": "object",
        "required": [
          "rating"
        ],
        "properties": {
          "rating": {
            "type": "integer",
            "minimum": 1,
            "maximum": 5
          },
          "title": {
            "type": "string"
          },
          "body": {
            "type": "string"
          }
        }
      },
      "CreateKeyRequest": {
        "type": "object",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "is_admin": {
            "type": "boolean",
            "default": false
          },
          "rate_limit": {
            "type": "integer",
            "default": 100
          }
        }
      },
      "HealthCheckResult": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "app_id": {
            "type": "string",
            "format": "uuid"
          },
          "app_name": {
            "type": "string"
          },
          "checked_url": {
            "type": "string",
            "format": "uri"
          },
          "status": {
            "type": "string",
            "enum": [
              "healthy",
              "unhealthy",
              "unreachable"
            ]
          },
          "status_code": {
            "type": "integer",
            "nullable": true
          },
          "response_time_ms": {
            "type": "integer"
          },
          "error_message": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "BatchHealthCheckResult": {
        "type": "object",
        "properties": {
          "total": {
            "type": "integer"
          },
          "healthy": {
            "type": "integer"
          },
          "unhealthy": {
            "type": "integer"
          },
          "unreachable": {
            "type": "integer"
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/HealthCheckResult"
            }
          }
        }
      },
      "Webhook": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "url": {
            "type": "string"
          },
          "events": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "active": {
            "type": "boolean"
          },
          "failure_count": {
            "type": "integer"
          },
          "last_triggered_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "WebhookWithSecret": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Webhook"
          },
          {
            "type": "object",
            "properties": {
              "secret": {
                "type": "string",
                "description": "HMAC secret for verifying webhook payloads. Shown only once at creation time."
              }
            }
          }
        ]
      },
      "WebhookPayload": {
        "type": "object",
        "description": "Payload delivered to webhook URLs",
        "properties": {
          "event": {
            "type": "string",
            "description": "Event type (e.g. app.submitted, review.submitted)"
          },
          "data": {
            "type": "object",
            "description": "Event-specific data"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "PendingApp": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "slug": {
            "type": "string"
          },
          "short_description": {
            "type": "string"
          },
          "protocol": {
            "type": "string"
          },
          "category": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "author_name": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "submitted_by_key_id": {
            "type": "string"
          }
        }
      }
    },
    "headers": {
      "X-RateLimit-Limit": {
        "description": "Maximum requests allowed in the current window",
        "schema": {
          "type": "integer"
        }
      },
      "X-RateLimit-Remaining": {
        "description": "Requests remaining in the current window",
        "schema": {
          "type": "integer"
        }
      },
      "X-RateLimit-Reset": {
        "description": "Seconds until the current window resets",
        "schema": {
          "type": "integer"
        }
      }
    },
    "responses": {
      "RateLimited": {
        "description": "Rate limit exceeded \u2014 try again after the window resets",
        "headers": {
          "X-RateLimit-Limit": {
            "$ref": "#/components/headers/X-RateLimit-Limit"
          },
          "X-RateLimit-Remaining": {
            "$ref": "#/components/headers/X-RateLimit-Remaining"
          },
          "X-RateLimit-Reset": {
            "$ref": "#/components/headers/X-RateLimit-Reset"
          }
        }
      }
    }
  }
}
